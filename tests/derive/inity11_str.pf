module inity11_str

   use MPI
   use pFunit
   use iso_c_binding
   implicit none

contains

   ! Serial test
   @test
   subroutine try_init()

      use decomp_2d, only : nrank, nproc, decomp_2d_abort

      implicit none

      integer :: code

      call MPI_COMM_RANK(MPI_COMM_WORLD,nrank,code)
      if (code /= 0) call decomp_2d_abort(code, "mpi_comm_rank")
      call MPI_COMM_SIZE(MPI_COMM_WORLD,nproc,code)
      if (code /= 0) call decomp_2d_abort(code, "mpi_comm_size")
      call init_xcompact3d("./y11_str.i3d"//c_null_char)

end subroutine try_init

end module inity11_str
